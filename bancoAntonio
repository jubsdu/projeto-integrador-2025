from dotenv import load_dotenv

from sqlalchemy import Column, Integer, String, Date, Time, Text, create_engine,ForeignKey, create_engine
import os
from sqlalchemy.orm import declarative_base,relationship, sessionmaker
load_dotenv()


DATABASE_URL = os.getenv("DATABASE_URL")
engine = create_engine(DATABASE_URL, pool_pre_ping=True, fast_executemany=True)

SessionLocal = sessionmaker(bind=engine)
Base = declarative_base()

# MODELS --------------------------------------------------

class Medicos(Base):
    __tablename__ = "medicos"
    id = Column(Integer, primary_key=True, autoincrement=True)
    nome = Column(String(100), nullable=False)
    especialidade = Column(String(100), nullable=False)
    telefone = Column(String(20))
    email = Column(String(100))
    consultas = relationship("Consultas", back_populates="medico")

class Pacientes(Base):
    __tablename__ = "pacientes"
    id = Column(Integer, primary_key=True, autoincrement=True)
    nome = Column(String(100), nullable=False)
    data_nascimento = Column(Date, nullable=False)
    telefone = Column(String(20))
    email = Column(String(100))
    consultas = relationship("Consultas", back_populates="paciente")

class Consultas(Base):
    __tablename__ = "consultas"
    id = Column(Integer, primary_key=True, autoincrement=True)
    data = Column(Date, nullable=False)
    horario = Column(Time, nullable=False)

    id_medico = Column(Integer, ForeignKey("medicos.id"))
    id_paciente = Column(Integer, ForeignKey("pacientes.id"))

    medico = relationship("Medicos", back_populates="consultas")
    paciente = relationship("Pacientes", back_populates="consultas")

Base.metadata.create_all(engine)





